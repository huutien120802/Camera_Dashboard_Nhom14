{"ast":null,"code":"import { put, takeLeading } from 'redux-saga/effects';\nimport jwtDecode from 'jwt-decode';\nimport userAPI from 'apis/user/userAPI';\nimport LOCATIONS from 'constants/index';\nimport { apiErrorHandler } from 'utils/index';\n\n// Login Redux States\nimport { toast } from 'react-toastify';\nimport { GET_USER_INFO, LOGOUT } from './actionTypes';\nimport { actionGetUserInfoSuccess, actionGetUserInfoFailed } from './actions';\nfunction getUserInfo(_ref) {\n  let {\n    payload\n  } = _ref;\n  return function* () {\n    try {\n      const token = localStorage.getItem('token');\n      const decoded = jwtDecode(token);\n      const {\n        userId\n      } = decoded;\n      const response = yield userAPI.getUserInfo(userId);\n      yield put(actionGetUserInfoSuccess(response));\n    } catch (error) {\n      apiErrorHandler(error);\n      localStorage.removeItem('token');\n      payload === null || payload === void 0 ? void 0 : payload.navigate(LOCATIONS.LOGIN);\n      yield put(actionGetUserInfoFailed());\n    }\n  }();\n}\nfunction logout(_ref2) {\n  let {\n    payload\n  } = _ref2;\n  try {\n    const {\n      navigate\n    } = payload;\n    localStorage.removeItem('token');\n    toast.info('You have been logged out successfully.');\n    navigate(LOCATIONS.LOGIN);\n  } catch (error) {\n    apiErrorHandler(error);\n  }\n}\nexport default function* UserProfileSaga() {\n  yield takeLeading(GET_USER_INFO, getUserInfo);\n  yield takeLeading(LOGOUT, logout);\n}\n_c = UserProfileSaga;\nvar _c;\n$RefreshReg$(_c, \"UserProfileSaga\");","map":{"version":3,"names":["put","takeLeading","jwtDecode","userAPI","LOCATIONS","apiErrorHandler","toast","GET_USER_INFO","LOGOUT","actionGetUserInfoSuccess","actionGetUserInfoFailed","getUserInfo","_ref","payload","token","localStorage","getItem","decoded","userId","response","error","removeItem","navigate","LOGIN","logout","_ref2","info","UserProfileSaga","_c","$RefreshReg$"],"sources":["D:/HKII-2023/Camera_Dashboard_Nhom14/src/store/user/saga.js"],"sourcesContent":["import { put, takeLeading } from 'redux-saga/effects';\r\nimport jwtDecode from 'jwt-decode';\r\n\r\nimport userAPI from 'apis/user/userAPI';\r\n\r\nimport LOCATIONS from 'constants/index';\r\n\r\nimport {\r\n  apiErrorHandler,\r\n} from 'utils/index';\r\n\r\n// Login Redux States\r\nimport { toast } from 'react-toastify';\r\nimport {\r\n  GET_USER_INFO,\r\n  LOGOUT,\r\n} from './actionTypes';\r\n\r\nimport {\r\n  actionGetUserInfoSuccess,\r\n  actionGetUserInfoFailed,\r\n} from './actions';\r\n\r\nfunction* getUserInfo({ payload }) {\r\n  try {\r\n    const token = localStorage.getItem('token');\r\n    const decoded = jwtDecode(token);\r\n    const { userId } = decoded;\r\n    const response = yield userAPI.getUserInfo(userId);\r\n\r\n    yield put(actionGetUserInfoSuccess(response));\r\n  } catch (error) {\r\n    apiErrorHandler(error);\r\n\r\n    localStorage.removeItem('token');\r\n    payload?.navigate(LOCATIONS.LOGIN);\r\n\r\n    yield put(actionGetUserInfoFailed());\r\n  }\r\n}\r\n\r\nfunction logout({ payload }) {\r\n  try {\r\n    const { navigate } = payload;\r\n\r\n    localStorage.removeItem('token');\r\n\r\n    toast.info('You have been logged out successfully.');\r\n\r\n    navigate(LOCATIONS.LOGIN);\r\n  } catch (error) {\r\n    apiErrorHandler(error);\r\n  }\r\n}\r\n\r\nexport default function* UserProfileSaga() {\r\n  yield takeLeading(GET_USER_INFO, getUserInfo);\r\n  yield takeLeading(LOGOUT, logout);\r\n}\r\n"],"mappings":"AAAA,SAASA,GAAG,EAAEC,WAAW,QAAQ,oBAAoB;AACrD,OAAOC,SAAS,MAAM,YAAY;AAElC,OAAOC,OAAO,MAAM,mBAAmB;AAEvC,OAAOC,SAAS,MAAM,iBAAiB;AAEvC,SACEC,eAAe,QACV,aAAa;;AAEpB;AACA,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SACEC,aAAa,EACbC,MAAM,QACD,eAAe;AAEtB,SACEC,wBAAwB,EACxBC,uBAAuB,QAClB,WAAW;AAElB,SAAUC,WAAWA,CAAAC,IAAA;EAAA,IAAC;IAAEC;EAAQ,CAAC,GAAAD,IAAA;EAAA,oBAAE;IACjC,IAAI;MACF,MAAME,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,MAAMC,OAAO,GAAGf,SAAS,CAACY,KAAK,CAAC;MAChC,MAAM;QAAEI;MAAO,CAAC,GAAGD,OAAO;MAC1B,MAAME,QAAQ,GAAG,MAAMhB,OAAO,CAACQ,WAAW,CAACO,MAAM,CAAC;MAElD,MAAMlB,GAAG,CAACS,wBAAwB,CAACU,QAAQ,CAAC,CAAC;IAC/C,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdf,eAAe,CAACe,KAAK,CAAC;MAEtBL,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;MAChCR,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAES,QAAQ,CAAClB,SAAS,CAACmB,KAAK,CAAC;MAElC,MAAMvB,GAAG,CAACU,uBAAuB,CAAC,CAAC,CAAC;IACtC;EACF,CAAC;AAAA;AAED,SAASc,MAAMA,CAAAC,KAAA,EAAc;EAAA,IAAb;IAAEZ;EAAQ,CAAC,GAAAY,KAAA;EACzB,IAAI;IACF,MAAM;MAAEH;IAAS,CAAC,GAAGT,OAAO;IAE5BE,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;IAEhCf,KAAK,CAACoB,IAAI,CAAC,wCAAwC,CAAC;IAEpDJ,QAAQ,CAAClB,SAAS,CAACmB,KAAK,CAAC;EAC3B,CAAC,CAAC,OAAOH,KAAK,EAAE;IACdf,eAAe,CAACe,KAAK,CAAC;EACxB;AACF;AAEA,eAAe,UAAUO,eAAeA,CAAA,EAAG;EACzC,MAAM1B,WAAW,CAACM,aAAa,EAAEI,WAAW,CAAC;EAC7C,MAAMV,WAAW,CAACO,MAAM,EAAEgB,MAAM,CAAC;AACnC;AAACI,EAAA,GAHwBD,eAAe;AAAA,IAAAC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}